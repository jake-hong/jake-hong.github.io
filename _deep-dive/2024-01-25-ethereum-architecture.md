---
layout: single
title: "ì´ë”ë¦¬ì›€ ì•„í‚¤í…ì²˜ì™€ EVM ë™ì‘ ì›ë¦¬"
date: 2024-01-25
categories: [deep-dive]
tags: [ethereum, evm, blockchain, architecture, web3]
sidebar:
  nav: "main"
---

# ì´ë”ë¦¬ì›€ ì•„í‚¤í…ì²˜ì™€ EVM ë™ì‘ ì›ë¦¬

## ğŸ—ï¸ ì´ë”ë¦¬ì›€ ì•„í‚¤í…ì²˜ ê°œìš”

ì´ë”ë¦¬ì›€ì€ ë‹¨ìˆœí•œ ì•”í˜¸í™”íê°€ ì•„ë‹Œ **ë¶„ì‚° ì»´í“¨íŒ… í”Œë«í¼**ì…ë‹ˆë‹¤. ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ê°€ìƒ ë¨¸ì‹ ì¸ EVM(Ethereum Virtual Machine)ì„ ì¤‘ì‹¬ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

## ğŸ”§ EVM (Ethereum Virtual Machine)

### 1. EVMì˜ ì—­í• 

- **ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ì‹¤í–‰**: Solidityë¡œ ì‘ì„±ëœ ì½”ë“œë¥¼ ë°”ì´íŠ¸ì½”ë“œë¡œ ì»´íŒŒì¼í•˜ì—¬ ì‹¤í–‰
- **ê°€ìŠ¤ ê³„ì‚°**: ì—°ì‚° ë¹„ìš©ì„ ê°€ìŠ¤ ë‹¨ìœ„ë¡œ ì¸¡ì •
- **ìƒíƒœ ê´€ë¦¬**: ë¸”ë¡ì²´ì¸ì˜ ìƒíƒœë¥¼ ì €ì¥í•˜ê³  ì—…ë°ì´íŠ¸

### 2. EVM ìŠ¤íƒ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Stack (1024)  â”‚ â† ì—°ì‚°ì— ì‚¬ìš©ë˜ëŠ” ì„ì‹œ ë°ì´í„°
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Memory        â”‚ â† í•¨ìˆ˜ í˜¸ì¶œ ì¤‘ ì„ì‹œ ì €ì¥ì†Œ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Storage       â”‚ â† ì˜êµ¬ ì €ì¥ì†Œ (ê°€ì¥ ë¹„ìŒˆ)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Calldata      â”‚ â† í•¨ìˆ˜ í˜¸ì¶œ ì‹œ ì „ë‹¬ëœ ë°ì´í„°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. ê°€ìŠ¤ ë©”ì»¤ë‹ˆì¦˜

```solidity
// ê°€ìŠ¤ ì†Œë¹„ ì˜ˆì‹œ
uint256 public value;  // Storage: 20,000 gas
function setValue(uint256 _value) public {
    value = _value;    // Storage write: 20,000 gas
}
```

## ğŸŒ ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°

### 1. ë…¸ë“œ ìœ í˜•

- **Full Node**: ì „ì²´ ë¸”ë¡ì²´ì¸ ë°ì´í„° ì €ì¥
- **Archive Node**: ëª¨ë“  ê³¼ê±° ìƒíƒœ ì €ì¥
- **Light Node**: í—¤ë”ë§Œ ì €ì¥ (SPV)

### 2. í•©ì˜ ë©”ì»¤ë‹ˆì¦˜

**ì´ì „ (PoW)**:
- ë§ˆì´ë„ˆë“¤ì´ í•´ì‹œ í¼ì¦ì„ í’€ì–´ ë¸”ë¡ ìƒì„±
- ë†’ì€ ì—ë„ˆì§€ ì†Œë¹„, ëŠë¦° ì²˜ë¦¬ ì†ë„

**í˜„ì¬ (PoS)**:
- ê²€ì¦ìë“¤ì´ ETHë¥¼ ìŠ¤í…Œì´í‚¹í•˜ì—¬ ë¸”ë¡ ê²€ì¦
- ì—ë„ˆì§€ íš¨ìœ¨ì , ë¹ ë¥¸ ì²˜ë¦¬ ì†ë„

## ğŸ”„ íŠ¸ëœì­ì…˜ ì²˜ë¦¬ ê³¼ì •

1. **íŠ¸ëœì­ì…˜ ìƒì„±**: ì‚¬ìš©ìê°€ ì„œëª…í•˜ì—¬ ìƒì„±
2. **ë©”ëª¨ë¦¬ í’€**: ëŒ€ê¸° ì¤‘ì¸ íŠ¸ëœì­ì…˜ë“¤
3. **ë¸”ë¡ ìƒì„±**: ê²€ì¦ìê°€ íŠ¸ëœì­ì…˜ë“¤ì„ ë¸”ë¡ì— í¬í•¨
4. **ì‹¤í–‰**: EVMì—ì„œ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ì‹¤í–‰
5. **ìƒíƒœ ì—…ë°ì´íŠ¸**: ê²°ê³¼ë¥¼ ë¸”ë¡ì²´ì¸ì— ê¸°ë¡

## ğŸ’¡ ì‹¤ì œ êµ¬í˜„ ì˜ˆì‹œ

### ê°„ë‹¨í•œ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract SimpleStorage {
    uint256 private storedData;
    
    event DataStored(uint256 indexed data);
    
    function set(uint256 x) public {
        storedData = x;
        emit DataStored(x);
    }
    
    function get() public view returns (uint256) {
        return storedData;
    }
}
```

## ğŸš€ ìµœì í™” ì „ëµ

### 1. ê°€ìŠ¤ ìµœì í™”

- **Packed Structs**: ì—¬ëŸ¬ ë³€ìˆ˜ë¥¼ í•˜ë‚˜ì˜ ìŠ¬ë¡¯ì— ì €ì¥
- **Events**: ë¡œê·¸ëŠ” Storageë³´ë‹¤ ì €ë ´
- **Libraries**: ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì½”ë“œ ë¶„ë¦¬

### 2. ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

- **Reentrancy**: ì¬ì§„ì… ê³µê²© ë°©ì§€
- **Integer Overflow**: SafeMath ì‚¬ìš©
- **Access Control**: ì ì ˆí•œ ê¶Œí•œ ê´€ë¦¬

## ğŸ“Š ì„±ëŠ¥ ë¹„êµ

| íŠ¹ì„± | ì´ë”ë¦¬ì›€ | Polygon | Arbitrum |
|------|----------|---------|----------|
| TPS | ~15 | ~7,000 | ~4,000 |
| ê°€ìŠ¤ë¹„ | ë†’ìŒ | ë‚®ìŒ | ë‚®ìŒ |
| ë³´ì•ˆ | ë†’ìŒ | ì¤‘ê°„ | ë†’ìŒ |

## ğŸ”® ë¯¸ë˜ ì „ë§

- **EIP-4844 (Proto-Danksharding)**: L2 í™•ì¥ì„± ê°œì„ 
- **Account Abstraction**: ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ
- **Zero-Knowledge Proofs**: í”„ë¼ì´ë²„ì‹œ ê°•í™”

## ğŸ“š ì°¸ê³  ìë£Œ

- [Ethereum Yellow Paper](https://ethereum.github.io/yellowpaper/paper.pdf)
- [EVM Opcodes](https://ethereum.org/en/developers/docs/evm/opcodes/)
- [Gas Optimization](https://docs.openzeppelin.com/learn/developing-smart-contracts)
